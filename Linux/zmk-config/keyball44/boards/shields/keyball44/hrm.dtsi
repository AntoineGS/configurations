// Key position constants
#define KEYS_L 0 1 2 3 4 5 12 13 14 15 16 17 24 25 26 27 28 29  // Left hand keys
#define KEYS_R 6 7 8 9 10 11 18 19 20 21 22 23 30 31 32 33 34 35  // Right hand keys
#define THUMBS 36 37 38 39 40 41 42 43  // All thumb keys

// Timing constants for homerow mods and hold-tap behaviors
#define HRM_TAPPING_TERM 280
#define HRM_QUICK_TAP 175
#define HRM_PRIOR_IDLE 150
#define LT_TAPPING_TERM 240
#define LT_QUICK_TAP 175

// Helper for homerow mod hold-tap behaviors
// Creates a hold-tap with configurable trigger positions (for left/right hand)
#define HOMEROW_MOD(trigger_positions) \
    compatible = "zmk,behavior-hold-tap"; \
    #binding-cells = <2>; \
    flavor = "balanced"; \
    tapping-term-ms = <HRM_TAPPING_TERM>; \
    quick-tap-ms = <HRM_QUICK_TAP>; \
    require-prior-idle-ms = <HRM_PRIOR_IDLE>; \
    bindings = <&kp>, <&kp>; \
    hold-trigger-key-positions = <trigger_positions>; \
    hold-trigger-on-release;

// Helper for hold-tap behaviors with French accent macros
// Takes modifier key as first parameter (for &kp) and 0 as second (accent macro ignores it)
// Usage: &egrv_hrm LGUI 0
#define ACCENT_HRM(accent_macro) \
    compatible = "zmk,behavior-hold-tap"; \
    #binding-cells = <2>; \
    flavor = "balanced"; \
    tapping-term-ms = <HRM_TAPPING_TERM>; \
    quick-tap-ms = <HRM_QUICK_TAP>; \
    require-prior-idle-ms = <HRM_PRIOR_IDLE>; \
    bindings = <&kp>, <&accent_macro>; \
    hold-trigger-key-positions = <KEYS_R THUMBS>; \
    hold-trigger-on-release;

/ {
    behaviors {
        // Timeless homerow mods
        hml: homerow_mods_left { HOMEROW_MOD(KEYS_R THUMBS) }; // left hand
        hmr: homerow_mods_right { HOMEROW_MOD(KEYS_L THUMBS) }; // right hand

        // Hold-tap behaviors for French accents with home row mods Usage: &egrv_hrm LGUI, &ecir_hrm LALT, &eacu_hrm LCTRL
        egrv_hrm: egrv_homerow_mod { ACCENT_HRM(e_grv) }; // è with mod (pass mod key at usage)
        ecir_hrm: ecir_homerow_mod { ACCENT_HRM(e_cir) }; // ê with mod (pass mod key at usage)
        eacu_hrm: eacu_homerow_mod { ACCENT_HRM(e_acu) }; // é with mod (pass mod key at usage)
    };
};
